vars(mehcanismid), ~ as.character(.)) %>%
glimpse()
df_ssd_psnuim %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(ends_with("apr")), ~ as.double(.),
vars(mehcanismid), ~ as.character(.)) %>%
glimpse()
source('~/GitHub/DataPack/Scripts/00_datapack_initialize.R', echo=TRUE)
df_mechdistro <- read_rds(file.path(fvdata, paste0("ICPI_FactView_PSNU_IM_", datestamp, ".Rds")))
#cleanup PSNUs (dups & clusters)
source(file.path(scripts, "91_datapack_officialnames.R"))
df_mechdistro <-cleanup_mechs(df_mechdistro, rawdata)
source(file.path(scripts, "92_datapack_snu_adj.R"))
df_mechdistro <- cluster_snus(df_mechdistro)
df_mechdistro <- cleanup_snus(df_mechdistro)
rm(cleanup_mechs, cleanup_snus, cluster_snus)
df_mechdistro %>%
filter(indicator == "OVC_SERV") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
filter(fy2017apr!=0) %>%
kable(format.args = list(big.mark = ",", zero.print = FALSE))
df_mechdistro %>%
filter(indicator == "OVC_SERV") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
filter(fy2017apr!=0) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
df_ovc <- df_mechdistro %>%
#total numerator = sum of all program status -> filter
filter(indicator=="OVC_SERV" & standardizeddisaggregate == "ProgramStatus") %>%
#group up to OUxIMxType level & summarize (will need to change grouping for different datasets)
group_by(operatingunit, psnu, psnuuid, indicatortype, mechanismid, numeratordenom) %>%
summarize_at(vars(fy2017apr), funs(sum(., na.rm = TRUE))) %>%
ungroup() %>%
#add standardized disagg
add_column(standardizeddisaggregate = "Total Numerator", .before = "numeratordenom")
View(df_ovc)
df_mechdistro <- bind_rows(df_mechdistro, df_ovc)
rm(df_ovc)
df_mechdistro %>%
filter(indicator == "OVC_SERV") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
filter(fy2017apr!=0) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
df_mechdistro %>%
filter(indicator == "OVC_SERV") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
View(df_mechdistro)
##   Data Pack COP FY18
##   A.Chafetz, USAID
##   Purpose: generate output for IM targeting in Data Pack
##   Adopted from COP17 Stata code
##   Date: October 19, 2017
##   Updated: 2/05
## DEPENDENCIES
# run 00_datapack_initialize.R
# ICPI Fact View PSNU_IM
# 91_datapack_officialnames.R
# 92_datapack_snu_adj.R
## SETUP ---------------------------------------------------------------------------------------------------
#import
df_mechdistro <- read_rds(file.path(fvdata, paste0("ICPI_FactView_PSNU_IM_", datestamp, ".Rds")))
#cleanup PSNUs (dups & clusters)
source(file.path(scripts, "91_datapack_officialnames.R"))
df_mechdistro <-cleanup_mechs(df_mechdistro, rawdata)
source(file.path(scripts, "92_datapack_snu_adj.R"))
df_mechdistro <- cluster_snus(df_mechdistro)
df_mechdistro <- cleanup_snus(df_mechdistro)
rm(cleanup_mechs, cleanup_snus, cluster_snus)
#OVC Total Numerator Creation
df_ovc <- df_mechdistro %>%
#total numerator = sum of all program status -> filter
filter(indicator=="OVC_SERV" & standardizeddisaggregate == "ProgramStatus") %>%
#group up to OUxIMxType level & summarize (will need to change grouping for different datasets)
group_by(operatingunit, psnu, psnuuid, indicatortype, mechanismid, numeratordenom) %>%
summarize_at(vars(fy2017apr), funs(sum(., na.rm = TRUE))) %>%
ungroup() %>%
#add standardized disagg
add_column(standardizeddisaggregate = "Total Numerator", .before = "numeratordenom")
View(df_ovc)
df_ovc <- df_mechdistro %>%
#total numerator = sum of all program status -> filter
filter(indicator=="OVC_SERV" & standardizeddisaggregate == "ProgramStatus")
df_ovc <- df_mechdistro %>%
#total numerator = sum of all program status -> filter
filter(indicator=="OVC_SERV" & standardizeddisaggregate == "ProgramStatus") %>%
#group up to OUxIMxType level & summarize (will need to change grouping for different datasets)
group_by(operatingunit, psnu, psnuuid, indicatortype, mechanismid, numeratordenom) %>%
summarize_at(vars(fy2017apr), funs(sum(., na.rm = TRUE))) %>%
ungroup() %>%
#add standardized disagg
add_column(standardizeddisaggregate = "Total Numerator", .before = "numeratordenom")
df_mechdistro2 <- bind_rows(df_mechdistro, df_ovc)
df_mechdistro %>%
count()
df_ovc %>%
count()
df_mechdistro2 %>%
count()
6455451 + 3011
df_mechdistro %>%
filter(indicator == "OVC_SERV")
df_mechdistro %>%
filter(indicator == "OVC_SERV") %>%
count(indicator)
df_ovc %>%
filter(indicator == "OVC_SERV") %>%
count(indicator)
df_mechdistro2 %>%
filter(indicator == "OVC_SERV") %>%
count(indicator)
View(df_ovc)
df_ovc <- df_mechdistro %>%
#total numerator = sum of all program status -> filter
filter(indicator=="OVC_SERV" & standardizeddisaggregate == "ProgramStatus") %>%
#group up to OUxIMxType level & summarize (will need to change grouping for different datasets)
group_by(operatingunit, snu1, psnu, psnuuid, currentsnuprioritization, typemilitary, indicator, numeratordenom) %>%
summarize_at(vars(fy2017apr), funs(sum(., na.rm = TRUE))) %>%
ungroup() %>%
#add standardized disagg
add_column(standardizeddisaggregate = "Total Numerator", .before = "numeratordenom")
#add total numerator onto OUxIM
df_mechdistro2 <- bind_rows(df_mechdistro, df_ovc)
df_mechdistro %>%
filter(indicator == "OVC_SERV") %>%
count(indicator)
df_ovc %>%
filter(indicator == "OVC_SERV") %>%
count(indicator)
df_mechdistro2 %>%
filter(indicator == "OVC_SERV") %>%
count(indicator)
179637 - 1266
rm(df_mechdistro2)
df_mechdistro <- bind_rows(df_mechdistro, df_ovc)
rm(df_ovc)
#collapse to unique list of psnus
df_dedups <- df_mechdistro %>%
#filter(is.na(typemilitary)) %>%
distinct(operatingunit, psnuuid, psnu) %>%
filter(!is.na(psnuuid)) %>%
mutate(DSD = "00000", TA = "00000") %>%
gather(indicatortype, mechanismid, DSD, TA)
df_mechdistro %>%
filter(indicator == "OVC_SERV") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
rm(df_dedups, df_mechdistro)
#Libraries
library(tidyverse)
library(readxl)
#import South Sudan's data
df_ssd_psnuim <- read_excel(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.xlsx")) %>%
rename_all(tolower)
View(df_ssd_psnuim)
glimpse(df_ssd_psnuim)
df_ssd_psnuim %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(contains("apr"), contains("targets")), ~ as.double(.),
vars(mehcanismid), ~ as.character(.))
df_ssd_psnuim %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(contains("apr"), contains("targets")), ~ as.double(.),
vars(mehcanismid), ~ as.character(.)) %>%
glimpse()
df_ssd_psnuim %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(contains("apr")), ~ as.double(.),
vars(mehcanismid), ~ as.character(.)) %>%
glimpse()
df_ssd_psnuim %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(fy2015apr), ~ as.double(.),
vars(mehcanismid), ~ as.character(.)) %>%
glimpse()
??"lgl"
df_ssd_psnuim <- read_excel(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.xlsx"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d",
FY2018_TARGETS = "d")) %>%
rename_all(tolower)
df_ssd_psnuim <- read_excel(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.xlsx"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)
df_ssd_psnuim <- read_excel(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.xlsx"),
col_types = cols(FY2015APR = "d"))
#import South Sudan's data
df_ssd_psnuim <- read_excel(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.xlsx"))
glimpse(df_ssd_psnuim)
#import South Sudan's data
df_ssd_psnuim <- read_excel(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.xlsx"),
col_types = FY2016_TARGETS = "d",
FY2016APR = "d",))
#import South Sudan's data
df_ssd_psnuim <- read_excel(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.xlsx"),
col_types = cols(FY2016_TARGETS = "d",
FY2016APR = "d"))
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2016_TARGETS = "d",
FY2016APR = "d"))
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)
rm(df_ssd_psnuim)
#import South Sudan's data
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)
rm(df_ssd_psnuim)
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)
rm(df_ssd_psnuim)
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"))
#import South Sudan's data
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"))
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)
df_ssd_psnuim %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(contains("apr"), contains("targets")), ~ as.double(.),
vars(mehcanismid), ~ as.character(.)) %>%
glimpse()
#import
df_mer <- read_rds(Sys.glob(file.path(fvdata, "ICPI_FactView_PSNU_*.Rds")))
df_mer <- read_rds(Sys.glob(file.path(fvdata, "ICPI_FactView_PSNU_*.Rds")))
#import
df_mer <- read_rds(Sys.glob(file.path(fvdata, "ICPI_FactView_PSNU_*.RDS")))
#import
df_mer <- read_rds(file.path(fvdata, Sys.glob("ICPI_FactView_PSNU_*.Rds")))
summary(df_ssd_psnuim$fy2015q3)
df_ssd_psnuim %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(contains("apr"), contains("targets")), ~ as.double(.)) %>%
glimpse()
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)
df_ssd_psnuim %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(contains("apr"), contains("targets")), ~ as.double(.))
#import South Sudan's data
df_ssd_psnuim <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)  %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(contains("apr"), contains("targets")), ~ as.double(.))
View(df_ssd_psnuim)
summary(df_ssd_psnuim)
#convert PSNUxIM to PSNU to append to Fact View
df_ssd_psnu <- df_ssd_psnuim %>%
select(-mechanismuid:-implementingmechanismname) %>%
mutate(mechanismid = as.character(mechanismid)) %>%
group_by_if(is.character) %>%
summarise_if(!is.character, ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
mutate(mechanismid = as.integer(mechanismid))
#convert PSNUxIM to PSNU to append to Fact View
df_ssd_psnu <- df_ssd_psnuim %>%
select(-mechanismuid:-implementingmechanismname) %>%
group_by_if(is.character) %>%
summarise_if(!is.character, ~ sum(., na.rm = TRUE)) %>%
ungroup()
#convert PSNUxIM to PSNU to append to Fact View
df_ssd_psnu <- df_ssd_psnuim %>%
select(-mechanismuid:-implementingmechanismname) %>%
group_by_if(is.character) %>%
summarise_if(is.numeric, ~ sum(., na.rm = TRUE)) %>%
ungroup()
df_ssd_psnuim %>% filter(is.numeric) %>% glimpse()
df_ssd_psnuim %>% filter(is.numeric(.)) %>% glimpse()
#convert PSNUxIM to PSNU to append to Fact View
df_ssd_psnu <- df_ssd_psnuim %>%
select(-mechanismuid:-implementingmechanismname) %>%
group_by_if(is.character) %>%
summarise_if(is.numeric, ~ sum(., na.rm = TRUE)) %>%
ungroup()
df_ssd_psnuim %>%
filter(indicator == "OVC_SERV") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
filter(fy2017apr!=0) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
df_ssd_psnu %>%
filter(indicator == "OVC_SERV") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
filter(fy2017apr!=0) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
df_ssd_psnu %>%
filter(indicator == "TX_NEW") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
filter(fy2017apr!=0) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
df_ssd_psnuim %>%
filter(indicator == "TX_NEW") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
filter(fy2017apr!=0) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
df_ssd_ouim <- df_ssd_psnuim %>%
select(-snu1:-typemilitary) %>%
mutate(mechanismid = as.character(mechanismid)) %>%
group_by_if(is.character) %>%
summarise_if(!is.character, ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
mutate(mechanismid = as.integer(mechanismid))
#convert PSNUxIM to OUxIm to append to FactView
df_ssd_ouim <- df_ssd_psnuim %>%
select(-snu1:-typemilitary) %>%
mutate(mechanismid = as.character(mechanismid)) %>%
group_by_if(is.character) %>%
summarise_if(is.numeric, ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
mutate(mechanismid = as.integer(mechanismid))
df_ssd_ouim %>%
filter(indicator == "TX_NEW") %>%
group_by(standardizeddisaggregate) %>%
summarise_at(vars(fy2017apr), ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
arrange(desc(fy2017apr)) %>%
filter(fy2017apr!=0) %>%
knitr::kable(format.args = list(big.mark = ",", zero.print = FALSE))
df_mer <- read_rds(Sys.glob("~/ICPI/Data/ICPI_FactView_OU_IM*.Rds"))
df_mer %>%
group_by(indicator) %>%
summarise_at(vars(fy2015apr, fy2017apr), ~ sum(., na.rm = TRUE))
df_mer %>%
group_by(operatingunit) %>%
summarise_at(vars(fy2015apr, fy2016apr, fy2017apr), ~ sum(., na.rm = TRUE)) %>%
print(n = Inf)
df_mer2 <- df_mer %>%
mutate_at(vars(fy2015q2:fy2017apr), ifelse(operatingunit == "South Sudan", NA, .))
df_mer2 <- df_mer %>%
mutate_at(vars(fy2015q2:fy2017apr), ifelse(operatingunit = "South Sudan", NA, .))
df_mer2 <- df_mer %>%
mutate_at(vars(fy2015q2:fy2017apr), . = ifelse(operatingunit == "South Sudan", NA, .))
df_mer2 <- df_mer %>%
mutate_at(vars(fy2015q2:fy2017apr), ifelse(operatingunit == "South Sudan", NA, .))
tibble(x = "a", "b", "c", "d", y = 1:4, z = y*2 )
tibble(x = c("a", "b", "c", "d"), y = 1:4, z = y*2 )
test <- tibble(x = c("a", "b", "c", "d"), y = 1:4, z = y*2 )
mutate_at(vars(y, z), NA)
test %>% mutate_at(vars(y, z), NA)
test %>% mutate_at(vars(y, z), . = NA)
test %>% mutate_at(vars(y, z), ~ NA)
test %>% mutate_at(vars(y, z), ~ ifelse(x == "a", NA, .))
test %>% mutate_at(vars(y, z), ~ifelse(x == "a", NA, .))
test %>% mutate_at(vars(y, z), ~ifelse(x = "a", NA, .))
test %>% mutate_at(vars(y, z), ~ifelse(test$x = "a", NA, .))
test %>% mutate_at(vars(y, z), ~ifelse(test$x == "a", NA, .))
test %>% mutate_at(vars(y, z), ~ifelse(.$x == "a", NA, .))
test %>% mutate_at(vars(y, z), ~ifelse(x == "a", NA, .))
test %>% mutate_at(vars(y, z), ~ifelse(test$x == "a", NA, .))
test %>% mutate(vars(y, z), ~if_else(x == "a", NA, .))
df_mer2 <- df_mer %>%
mutate_at(vars(fy2015q2:fy2017apr), ifelse(df_mer$operatingunit == "South Sudan", NA, .))
df_mer2 <- df_mer %>%
mutate_at(vars(fy2015q2:fy2017apr), ~ ifelse(df_mer$operatingunit == "South Sudan", NA, .))
df_mer %>%
group_by(operatingunit) %>%
summarise_at(vars(fy2015apr, fy2016apr, fy2017apr), ~ sum(., na.rm = TRUE)) %>%
print(n = Inf)
df_mer2 %>%
group_by(operatingunit) %>%
summarise_at(vars(fy2015apr, fy2016apr, fy2017apr), ~ sum(., na.rm = TRUE)) %>%
print(n = Inf)
df_mer2 %>%
group_by(operatingunit) %>%
summarise_at(vars(fy2015apr, fy2016apr, fy2017apr, fy2018_targets), ~ sum(., na.rm = TRUE)) %>%
print(n = Inf)
source('~/GitHub/DataPack/Scripts/97_datapack_ssd_adjustment.R', echo=TRUE)
source('~/GitHub/DataPack/Scripts/97_datapack_ssd_adjustment.R', echo=TRUE)
df_mer2 <- df_mer
add_ssd_fv(df_mer2, "OUxIM")
rm(df_mer2)
rm(df_ssd_ouim, df_ssd_psnu, df_ssd_psnuim)
type <- "OUxIM"
rm(test)
df_ssd <- read_tsv(file.path(fvdata, "SSudan PSNUxIM FactView Dec22V2.txt"),
col_types = cols(FY2015APR = "d",
FY2016_TARGETS = "d",
FY2016APR = "d",
FY2017_TARGETS = "d",
FY2017APR = "d")) %>%
rename_all(tolower)  %>%
#convert to integer/double/character for merge
mutate_at(vars(contains("q")), ~ as.integer(.),
vars(contains("apr"), contains("targets")), ~ as.double(.))
df <- df_mer
if (type == "PSNU") {
df_ssd <- df_ssd %>%
select(-mechanismuid:-implementingmechanismname) %>%
group_by_if(is.character) %>%
summarise_if(is.numeric, ~ sum(., na.rm = TRUE)) %>%
ungroup()
}
if (type == "OUxIM") {
df_ssd <- df_ssd %>%
select(-snu1:-typemilitary) %>%
mutate(mechanismid = as.character(mechanismid)) %>%
group_by_if(is.character) %>%
summarise_if(is.numeric, ~ sum(., na.rm = TRUE)) %>%
ungroup() %>%
mutate(mechanismid = as.integer(mechanismid))
}
df <- df  %>%
mutate_at(vars(fy2015q2:fy2017apr), ~ ifelse(df$operatingunit == "South Sudan", NA, .))
#append new data onto bottom of mer dataframe
df <-  bind_rows(df, df_ssd)
??packrat
df <- readRDS("C:/Users/achafetz/Documents/ICPI/Data/ICPI_FactView_OU_IM_20171222_v2_2.Rds")
glimpse(df)
rm(df)
source('~/GitHub/DataPack/Scripts/00_datapack_initialize.R', echo=TRUE)
T_SUBNAT --------------------------------------------------------------------------------------------------
#import data
df_subnat <- read_rds(Sys.glob(file.path(fvdata, "ICPI_FactView_NAT_SUBNAT_*.Rds"))) %>%
#align nat_subnat names with what is in fact view
rename(fy2016apr = fy2016, fy2017apr = fy2017,
currentsnuprioritization = fy17snuprioritization) %>%
#add in standardized disaggegate as column since missing and that's what's used to generate new vars
mutate(standardizeddisaggregate = disaggregate)
#import data
df_subnat <- read_rds(Sys.glob(file.path(fvdata, "ICPI_FactView_NAT_SUBNAT_*.Rds"))) %>%
#align nat_subnat names with what is in fact view
rename(fy2016apr = fy2016, fy2017apr = fy2017,
currentsnuprioritization = fy17snuprioritization) %>%
#add in standardized disaggegate as column since missing and that's what's used to generate new vars
mutate(standardizeddisaggregate = disaggregate)
#import
df_mer <- read_rds(Sys.glob(file.path(fvdata, "ICPI_FactView_PSNU_*.Rds")))
#import
df_mer <- read_rds(Sys.glob(file.path(fvdata, "ICPI_FactView_PSNU_2*.Rds")))
source('~/GitHub/DataPack/Scripts/00_datapack_initialize.R', echo=TRUE)
source('~/GitHub/DataPack/Scripts/01_datapack_output.R', echo=TRUE)
source('~/GitHub/DataPack/Scripts/02_datapack_output_keyind.R', echo=TRUE)
source('~/GitHub/DataPack/Scripts/03_datapack_im_list.R', echo=TRUE)
source('~/GitHub/DataPack/Scripts/04_datapack_im_targeting.R', echo=TRUE)
source('~/GitHub/DataPack/Scripts/04_datapack_im_targeting.R', echo=TRUE)
